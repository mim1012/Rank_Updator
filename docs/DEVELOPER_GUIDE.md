# Developer Guide - ë„¤ì´ë²„ ì‡¼í•‘ ìˆœìœ„ ì²´í¬ ì‹œìŠ¤í…œ

**ë²„ì „**: 1.0
**ì‘ì„±ì¼**: 2025-12-29

ì´ ë¬¸ì„œëŠ” ê°œë°œìê°€ ì½”ë“œë² ì´ìŠ¤ë¥¼ ì´í•´í•˜ê³  ìˆ˜ì •í•  ìˆ˜ ìˆë„ë¡ í•µì‹¬ ë¡œì§ê³¼ ë°ì´í„° íë¦„ì„ ì„¤ëª…í•©ë‹ˆë‹¤.

---

## 1. ì‹œìŠ¤í…œ ê°œìš”

ë„¤ì´ë²„ ì‡¼í•‘ì—ì„œ íŠ¹ì • í‚¤ì›Œë“œë¡œ ê²€ìƒ‰ ì‹œ ìƒí’ˆì˜ ìˆœìœ„ë¥¼ ìë™ìœ¼ë¡œ ì²´í¬í•˜ê³  ì €ì¥í•˜ëŠ” ì‹œìŠ¤í…œì…ë‹ˆë‹¤.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ì „ì²´ íë¦„                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  1. Supabaseì—ì„œ        2. URLì—ì„œ MID ì¶”ì¶œ     3. ë„¤ì´ë²„ ì‡¼í•‘ì—ì„œ  â”‚
â”‚     í‚¤ì›Œë“œ ëª©ë¡ ì¡°íšŒ   â†’   (ìƒí’ˆ ê³ ìœ  ID)     â†’    ìˆœìœ„ ì²´í¬       â”‚
â”‚                                                                  â”‚
â”‚                        4. ìˆœìœ„ ê²°ê³¼ë¥¼ Supabaseì— ì €ì¥              â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. í•µì‹¬ ëª¨ë“ˆ êµ¬ì¡°

```
rank-check/
â”œâ”€â”€ batch/                      # ë°°ì¹˜ ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸
â”‚   â””â”€â”€ check-batch-worker-pool.ts   â­ ë©”ì¸ ì§„ì…ì 
â”‚
â”œâ”€â”€ parallel/                   # ë³‘ë ¬ ì²˜ë¦¬
â”‚   â””â”€â”€ parallel-rank-checker.ts     â­ ì›Œì»¤ í’€ ê´€ë¦¬
â”‚
â”œâ”€â”€ core/                       # í•µì‹¬ ì¸í„°í˜ì´ìŠ¤ ë° íƒ€ì…
â”‚   â”œâ”€â”€ interfaces/
â”‚   â”‚   â”œâ”€â”€ IRankChecker.ts          ìˆœìœ„ ì²´ì»¤ ì¸í„°í˜ì´ìŠ¤
â”‚   â”‚   â”œâ”€â”€ IProductCollector.ts     ìƒí’ˆ ìˆ˜ì§‘ê¸° ì¸í„°í˜ì´ìŠ¤
â”‚   â”‚   â”œâ”€â”€ INavigator.ts            ë„¤ë¹„ê²Œì´í„° ì¸í„°í˜ì´ìŠ¤
â”‚   â”‚   â””â”€â”€ ISecurityDetector.ts     ë³´ì•ˆ ê°ì§€ ì¸í„°í˜ì´ìŠ¤
â”‚   â”œâ”€â”€ types.ts                     ê³µí†µ íƒ€ì… ì •ì˜
â”‚   â””â”€â”€ RankChecker.ts               ìˆœìœ„ ì²´ì»¤ êµ¬í˜„
â”‚
â”œâ”€â”€ extractors/                 # MID ì¶”ì¶œê¸°ë“¤
â”‚   â”œâ”€â”€ QueryParamExtractor.ts       URL ì¿¼ë¦¬ì—ì„œ ì¶”ì¶œ
â”‚   â”œâ”€â”€ SmartStoreExtractor.ts       ìŠ¤ë§ˆíŠ¸ìŠ¤í† ì–´ í˜ì´ì§€ì—ì„œ ì¶”ì¶œ
â”‚   â”œâ”€â”€ CatalogExtractor.ts          ì¹´íƒˆë¡œê·¸ í˜ì´ì§€ì—ì„œ ì¶”ì¶œ
â”‚   â””â”€â”€ MidExtractorFactory.ts       ì¶”ì¶œê¸° íŒ©í† ë¦¬
â”‚
â”œâ”€â”€ collectors/                 # ìƒí’ˆ ëª©ë¡ ìˆ˜ì§‘ê¸°
â”‚   â”œâ”€â”€ DomProductCollector.ts       DOMì—ì„œ ìƒí’ˆ ìˆ˜ì§‘
â”‚   â”œâ”€â”€ ApiProductCollector.ts       API ì‘ë‹µì—ì„œ ìˆ˜ì§‘
â”‚   â””â”€â”€ HybridProductCollector.ts    í•˜ì´ë¸Œë¦¬ë“œ ë°©ì‹
â”‚
â”œâ”€â”€ navigation/                 # í˜ì´ì§€ ì´ë™
â”‚   â””â”€â”€ ShoppingTabNavigator.ts      ì‡¼í•‘íƒ­ ì§„ì…/í˜ì´ì§€ ì´ë™
â”‚
â”œâ”€â”€ security/                   # ë³´ì•ˆ ê°ì§€
â”‚   â””â”€â”€ CaptchaDetector.ts           ìº¡ì± /ì°¨ë‹¨ ê°ì§€
â”‚
â”œâ”€â”€ utils/                      # ìœ í‹¸ë¦¬í‹°
â”‚   â”œâ”€â”€ save-rank-to-slot-naver.ts   Supabase ì €ì¥
â”‚   â”œâ”€â”€ url-to-mid-converter.ts      URL â†’ MID ë³€í™˜
â”‚   â”œâ”€â”€ ipRotation.ts                IP ë¡œí…Œì´ì…˜
â”‚   â””â”€â”€ humanBehavior.ts             íœ´ë¨¼ í–‰ë™ ì‹œë®¬ë ˆì´ì…˜
â”‚
â””â”€â”€ accurate-rank-checker.ts    # MID ê¸°ë°˜ ìˆœìœ„ ì²´í¬ (ë ˆê±°ì‹œ)
```

---

## 3. ë©”ì¸ ì‹¤í–‰ íë¦„ (Flow Chart)

### 3.1 ë°°ì¹˜ ì‹¤í–‰ íë¦„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              check-batch-worker-pool.ts ì‹¤í–‰                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. Supabaseì—ì„œ ì²˜ë¦¬í•  í‚¤ì›Œë“œ ì¡°íšŒ (claimKeywords)              â”‚
â”‚     - status = 'pending' ë˜ëŠ” 24ì‹œê°„ ì§€ë‚œ 'waiting'              â”‚
â”‚     - worker_id í• ë‹¹í•˜ì—¬ ì¤‘ë³µ ì²˜ë¦¬ ë°©ì§€                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. slot_naverì—ì„œ ê¸°ì¡´ MID ìºì‹œ ì¡°íšŒ (getCachedMids)            â”‚
â”‚     - ì´ë¯¸ MIDê°€ ì €ì¥ëœ URLì€ URL ë°©ë¬¸ skip                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3. ì›Œì»¤ í’€ ì‹¤í–‰ (checkUrlsWithWorkerPool)                      â”‚
â”‚     - 4ê°œ ë¸Œë¼ìš°ì €ê°€ ë…ë¦½ì ìœ¼ë¡œ ì‘ì—… ì²˜ë¦¬                        â”‚
â”‚     - í•˜ë‚˜ ëë‚˜ë©´ ë°”ë¡œ ë‹¤ìŒ ì‘ì—… ì‹œì‘ (ëŒ€ê¸° ì—†ìŒ)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚     ê° ì›Œì»¤ ë‚´ë¶€         â”‚
              â–¼                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ìŠ¤ë§ˆíŠ¸ìŠ¤í† ì–´ URL?       â”‚  â”‚  ì¹´íƒˆë¡œê·¸/ê¸°íƒ€ URL?      â”‚
â”‚  â†’ ProductId ë°©ì‹       â”‚  â”‚  â†’ MID ë°©ì‹              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                             â”‚
            â–¼                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  4. ìˆœìœ„ ì²´í¬ ê²°ê³¼ ì €ì¥ (processResult â†’ saveRankToSlotNaver)    â”‚
â”‚     - slot_naver í…Œì´ë¸”ì— current_rank ì—…ë°ì´íŠ¸                  â”‚
â”‚     - slot_rank_naver_history í…Œì´ë¸”ì— ì´ë ¥ ì¶”ê°€                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  5. keywords_navershoppingì—ì„œ ì²˜ë¦¬ ì™„ë£Œëœ í–‰ ì‚­ì œ               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 ìˆœìœ„ ì²´í¬ ìƒì„¸ íë¦„ (ParallelRankChecker)

```
checkSingleUrl() í˜¸ì¶œ
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  puppeteer-real-browserë¡œ ë¸Œë¼ìš°ì € ì‹œì‘ â”‚
â”‚  - headless: false (ë´‡ íƒì§€ íšŒí”¼)       â”‚
â”‚  - ì›Œì»¤ë³„ í”„ë¡œí•„ ë””ë ‰í† ë¦¬ (ì„¸ì…˜ ìœ ì§€)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ ìŠ¤ë§ˆíŠ¸ìŠ¤í† ì–´ URL? â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚ YES                   â”‚ NO
     â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ProductId ë°©ì‹  â”‚   â”‚ MID ë°©ì‹           â”‚
â”‚                â”‚   â”‚                    â”‚
â”‚ 1. URLì—ì„œ      â”‚   â”‚ 1. cachedMid í™•ì¸  â”‚
â”‚    productId    â”‚   â”‚    ìˆìœ¼ë©´ ì‚¬ìš©     â”‚
â”‚    ì¶”ì¶œ         â”‚   â”‚                    â”‚
â”‚                â”‚   â”‚ 2. ì—†ìœ¼ë©´ URL ë°©ë¬¸  â”‚
â”‚ 2. ë„¤ì´ë²„ ë©”ì¸  â”‚   â”‚    â†’ urlToMid()    â”‚
â”‚    â†’ í‚¤ì›Œë“œ ê²€ìƒ‰â”‚   â”‚                    â”‚
â”‚    â†’ ì‡¼í•‘íƒ­ ì´ë™â”‚   â”‚ 3. findAccurateRankâ”‚
â”‚                â”‚   â”‚    ìœ¼ë¡œ ìˆœìœ„ ì²´í¬   â”‚
â”‚ 3. í˜ì´ì§€ë³„     â”‚   â”‚                    â”‚
â”‚    data-shp-*  â”‚   â”‚                    â”‚
â”‚    ì†ì„±ì—ì„œ     â”‚   â”‚                    â”‚
â”‚    productId   â”‚   â”‚                    â”‚
â”‚    ë§¤ì¹­        â”‚   â”‚                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                     â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â–¼
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚ ê²°ê³¼ ë°˜í™˜      â”‚
           â”‚ - rank        â”‚
           â”‚ - mid         â”‚
           â”‚ - productName â”‚
           â”‚ - blocked     â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. ë°ì´í„° íë¦„ (Data Flow)

### 4.1 í…Œì´ë¸” êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Supabase í…Œì´ë¸”                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  keywords_navershopping (ì‘ì—… í)                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ id | keyword | link_url | status | worker_id | started_atâ”‚   â”‚
â”‚  â”‚----+â”€â”€â”€â”€â”€â”€â”€â”€â”€+â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€+â”€â”€â”€â”€â”€â”€â”€â”€+â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€+â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚   â”‚
â”‚  â”‚ 1  | ìš´ë™í™”  | https:// | pending| null      | null      â”‚   â”‚
â”‚  â”‚ 2  | ê°€ë°©    | https:// | process| worker-1  | 2025-12-29â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â”‚                                  â”‚
â”‚                              â”‚ ìˆœìœ„ ì²´í¬ ì™„ë£Œ ì‹œ                  â”‚
â”‚                              â–¼                                  â”‚
â”‚  slot_naver (ìŠ¬ë¡¯ ì •ë³´ + í˜„ì¬ ìˆœìœ„)                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ id | keyword | link_url | mid | current_rank | updated_atâ”‚   â”‚
â”‚  â”‚----+â”€â”€â”€â”€â”€â”€â”€â”€â”€+â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€+â”€â”€â”€â”€â”€+â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€+â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚   â”‚
â”‚  â”‚ 1  | ìš´ë™í™”  | https:// | 123 | 45           | 2025-12-29â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â”‚                                  â”‚
â”‚                              â”‚ ì´ë ¥ ì €ì¥                         â”‚
â”‚                              â–¼                                  â”‚
â”‚  slot_rank_naver_history (ìˆœìœ„ ì´ë ¥)                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ id | slot_status_id | keyword | current_rank | created_atâ”‚   â”‚
â”‚  â”‚----+â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€+â”€â”€â”€â”€â”€â”€â”€â”€â”€+â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€+â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚   â”‚
â”‚  â”‚ 1  | 1              | ìš´ë™í™”  | 45           | 2025-12-29â”‚   â”‚
â”‚  â”‚ 2  | 1              | ìš´ë™í™”  | 42           | 2025-12-30â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 ë°ì´í„° íë¦„ ìƒì„¸

```
1. í‚¤ì›Œë“œ ì¡°íšŒ (claimKeywords)
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ SELECT * FROM keywords_navershopping                        â”‚
   â”‚ WHERE status = 'pending'                                    â”‚
   â”‚    OR (status = 'waiting' AND started_at < 24ì‹œê°„ì „)        â”‚
   â”‚ ORDER BY id DESC LIMIT 1000                                 â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ UPDATE keywords_navershopping                               â”‚
   â”‚ SET status = 'processing',                                  â”‚
   â”‚     worker_id = 'hostname-timestamp-random',                â”‚
   â”‚     started_at = NOW()                                      â”‚
   â”‚ WHERE id IN (...)                                           â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

2. MID ìºì‹œ ì¡°íšŒ (getCachedMids)
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ SELECT link_url, mid FROM slot_naver                        â”‚
   â”‚ WHERE link_url IN (...) AND mid IS NOT NULL                 â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

3. ìˆœìœ„ ì €ì¥ (saveRankToSlotNaver)
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ UPDATE slot_naver                                           â”‚
   â”‚ SET current_rank = 45,                                      â”‚
   â”‚     mid = '12345678',                                       â”‚
   â”‚     product_name = 'ìƒí’ˆëª…',                                 â”‚
   â”‚     updated_at = NOW()                                      â”‚
   â”‚ WHERE link_url = '...'                                      â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ INSERT INTO slot_rank_naver_history                         â”‚
   â”‚ (slot_status_id, keyword, current_rank, created_at)         â”‚
   â”‚ VALUES (1, 'ìš´ë™í™”', 45, NOW())                              â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

4. ì‘ì—… ì™„ë£Œ í›„ ì‚­ì œ
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ DELETE FROM keywords_navershopping WHERE id = 123           â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 5. í•µì‹¬ í•¨ìˆ˜ ì„¤ëª…

### 5.1 MID ì¶”ì¶œ (url-to-mid-converter.ts)

```typescript
/**
 * URLì—ì„œ MID(ìƒí’ˆ ê³ ìœ  ID)ë¥¼ ì¶”ì¶œí•©ë‹ˆë‹¤.
 *
 * MIDëŠ” ë„¤ì´ë²„ ì‡¼í•‘ì—ì„œ ìƒí’ˆì„ ì‹ë³„í•˜ëŠ” 10~12ìë¦¬ ìˆ«ìì…ë‹ˆë‹¤.
 * ê²€ìƒ‰ ê²°ê³¼ì—ì„œ ìƒí’ˆì„ ë§¤ì¹­í•  ë•Œ ì‚¬ìš©ë©ë‹ˆë‹¤.
 *
 * ì¶”ì¶œ ì „ëµ (ìš°ì„ ìˆœìœ„):
 * 1. URL ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°ì—ì„œ ì§ì ‘ ì¶”ì¶œ (?productId=xxx)
 * 2. ìŠ¤ë§ˆíŠ¸ìŠ¤í† ì–´ í˜ì´ì§€ ë°©ë¬¸ í›„ ì¶”ì¶œ
 * 3. ì¹´íƒˆë¡œê·¸ í˜ì´ì§€ ë°©ë¬¸ í›„ ì¶”ì¶œ
 */
async function urlToMid(url: string, page: Page): Promise<MidExtractionResult>
```

**ë°˜í™˜ íƒ€ì…:**
```typescript
interface MidExtractionResult {
  mid: string | null;
  source: 'direct' | 'catalog' | 'cached' | 'failed' | 'captcha_failed';
}
```

### 5.2 ìˆœìœ„ ì²´í¬ - ProductId ë°©ì‹ (parallel-rank-checker.ts)

```typescript
/**
 * ìŠ¤ë§ˆíŠ¸ìŠ¤í† ì–´ URLìš© ìˆœìœ„ ì²´í¬ (productId ê¸°ë°˜)
 *
 * ì¥ì :
 * - ìº¡ì±  ë°œìƒ í™•ë¥  ë‚®ìŒ
 * - URL ë°©ë¬¸ ì—†ì´ ë°”ë¡œ ê²€ìƒ‰ ê°€ëŠ¥
 *
 * ë™ì‘:
 * 1. URLì—ì„œ productId ì¶”ì¶œ (/products/12345)
 * 2. ë„¤ì´ë²„ ë©”ì¸ â†’ í‚¤ì›Œë“œ ê²€ìƒ‰ â†’ ì‡¼í•‘íƒ­ ì´ë™
 * 3. data-shp-contents-dtl ì†ì„±ì—ì„œ chnl_prod_no ë§¤ì¹­
 */
async function checkRankByProductId(
  page: Page,
  keyword: string,
  productId: string,
  logPrefix: string
): Promise<{
  rank: number | null;
  catalogNvMid: string | null;
  productName: string | null;
  page: number | null;
  isAd: boolean;
  blocked: boolean;
  error?: string;
}>
```

### 5.3 ìˆœìœ„ ì²´í¬ - MID ë°©ì‹ (accurate-rank-checker.ts)

```typescript
/**
 * MID ê¸°ë°˜ ìˆœìœ„ ì²´í¬ (ì¹´íƒˆë¡œê·¸ URLìš©)
 *
 * ë™ì‘:
 * 1. ì‡¼í•‘íƒ­ ì§„ì… (ë„¤ì´ë²„ ë©”ì¸ â†’ ê²€ìƒ‰ â†’ ì‡¼í•‘íƒ­)
 * 2. í˜ì´ì§€ë³„ ìƒí’ˆ ëª©ë¡ ìˆ˜ì§‘
 * 3. MID ë§¤ì¹­í•˜ì—¬ ìˆœìœ„ ê³„ì‚°
 *
 * ìˆœìœ„ ê³„ì‚°: (page - 1) * 40 + pagePosition
 */
async function findAccurateRank(
  page: Page,
  keyword: string,
  targetMid: string,
  maxPages?: number
): Promise<RankResult | null>
```

### 5.4 ê²°ê³¼ ì €ì¥ (save-rank-to-slot-naver.ts)

```typescript
/**
 * ìˆœìœ„ ê²°ê³¼ë¥¼ Supabaseì— ì €ì¥í•©ë‹ˆë‹¤.
 *
 * ë™ì‘:
 * 1. slot_naver í…Œì´ë¸”ì˜ current_rank ì—…ë°ì´íŠ¸
 * 2. slot_rank_naver_history í…Œì´ë¸”ì— ì´ë ¥ ì¶”ê°€
 */
async function saveRankToSlotNaver(
  supabase: SupabaseClient,
  keywordRecord: KeywordRecord,
  rankResult: RankResult
): Promise<{ success: boolean; error?: string }>
```

---

## 6. ìƒí’ˆ ë°ì´í„° ìˆ˜ì§‘ êµ¬ì¡°

### 6.1 DOM êµ¬ì¡° (ë„¤ì´ë²„ ì‡¼í•‘ ê²€ìƒ‰ ê²°ê³¼)

```html
<!-- ê° ìƒí’ˆ ì•„ì´í…œ -->
<a data-shp-contents-id="12345678901"     <!-- MID (nvMid) -->
   data-shp-contents-rank="15"            <!-- í˜ì´ì§€ ë‚´ ìˆœìœ„ -->
   data-shp-inventory="lst*N"             <!-- ê´‘ê³  ì—¬ë¶€: A/P/D = ê´‘ê³ , N = ì˜¤ê°€ë‹‰ -->
   data-shp-contents-dtl='[
     {"key":"chnl_prod_no","value":"12345"},       <!-- productId -->
     {"key":"catalog_nv_mid","value":"12345678"},  <!-- ì¹´íƒˆë¡œê·¸ MID -->
     {"key":"prod_nm","value":"ìƒí’ˆëª…"}            <!-- ìƒí’ˆëª… -->
   ]'>
   ...
</a>
```

### 6.2 ìˆ˜ì§‘ ì½”ë“œ ì˜ˆì‹œ

```typescript
// í˜ì´ì§€ì—ì„œ ìƒí’ˆ ëª©ë¡ ìˆ˜ì§‘
const products = await page.evaluate(() => {
  const anchors = document.querySelectorAll(
    'a[data-shp-contents-id][data-shp-contents-rank]'
  );

  return Array.from(anchors).map(anchor => {
    const mid = anchor.getAttribute('data-shp-contents-id');
    const rank = parseInt(anchor.getAttribute('data-shp-contents-rank') || '0');
    const inventory = anchor.getAttribute('data-shp-inventory') || '';
    const isAd = /lst\*(A|P|D)/.test(inventory);

    // dtl JSON íŒŒì‹±
    const dtl = anchor.getAttribute('data-shp-contents-dtl');
    let productId = null;
    let productName = null;

    if (dtl) {
      const parsed = JSON.parse(dtl.replace(/&quot;/g, '"'));
      for (const item of parsed) {
        if (item.key === 'chnl_prod_no') productId = item.value;
        if (item.key === 'prod_nm') productName = item.value;
      }
    }

    return { mid, rank, isAd, productId, productName };
  });
});
```

---

## 7. ì—ëŸ¬ ì²˜ë¦¬ ë° ë³µêµ¬

### 7.1 ì°¨ë‹¨ ê°ì§€

```typescript
// ì°¨ë‹¨ ì—¬ë¶€ í™•ì¸
async function isBlocked(page: Page): Promise<boolean> {
  return page.evaluate(() => {
    const bodyText = document.body?.innerText ?? '';
    return (
      bodyText.includes('ë³´ì•ˆ í™•ì¸') ||
      bodyText.includes('ìë™ ì…ë ¥ ë°©ì§€') ||
      bodyText.includes('ì¼ì‹œì ìœ¼ë¡œ ì œí•œ')
    );
  });
}
```

### 7.2 IP ë¡œí…Œì´ì…˜

```typescript
// ì—°ì† ì°¨ë‹¨ ì‹œ IP ë¡œí…Œì´ì…˜
const BLOCK_THRESHOLD = 5;

if (result.blocked) {
  consecutiveBlocked++;

  if (consecutiveBlocked >= BLOCK_THRESHOLD) {
    const rotationResult = await rotateIP();
    console.log(`IP ë³€ê²½: ${rotationResult.oldIP} â†’ ${rotationResult.newIP}`);
    consecutiveBlocked = 0;
  }
}
```

### 7.3 íƒ€ì„ì•„ì›ƒ ë³µêµ¬

```typescript
// 30ë¶„ ì´ìƒ processing ìƒíƒœì¸ ì‘ì—… ë³µêµ¬
async function recoverStaleKeywords(): Promise<number> {
  const staleTime = new Date(Date.now() - 30 * 60 * 1000).toISOString();

  const { data } = await supabase
    .from('keywords_navershopping')
    .update({ status: 'pending', worker_id: null })
    .eq('status', 'processing')
    .lt('started_at', staleTime)
    .select('id');

  return data?.length || 0;
}
```

---

## 8. ì‹¤í–‰ ë°©ë²•

### 8.1 ê¸°ë³¸ ì‹¤í–‰

```bash
# 4ê°œ ì›Œì»¤ë¡œ ì „ì²´ ì²˜ë¦¬
npx tsx rank-check/batch/check-batch-worker-pool.ts

# 2ê°œ ì›Œì»¤ë¡œ ì²˜ë¦¬
npx tsx rank-check/batch/check-batch-worker-pool.ts --workers=2

# 20ê°œë§Œ ì²˜ë¦¬
npx tsx rank-check/batch/check-batch-worker-pool.ts --limit=20
```

### 8.2 ëŸ°ì²˜ ì‹¤í–‰

```bash
# Windows ëŸ°ì²˜ (ìë™ ì¬ì‹œì‘ í¬í•¨)
.\bin\naverrank-launcher.exe
```

### 8.3 í™˜ê²½ ë³€ìˆ˜

```env
# Supabase
SUPABASE_URL=https://xxx.supabase.co
SUPABASE_SERVICE_ROLE_KEY=eyJ...

# ì„¤ì •
MAX_PAGES=15  # ìµœëŒ€ ê²€ìƒ‰ í˜ì´ì§€
```

---

## 9. ë””ë²„ê¹…

### 9.1 ë‹¨ì¼ í‚¤ì›Œë“œ í…ŒìŠ¤íŠ¸

```bash
npx tsx rank-check/single/check-mid-rank.ts
```

### 9.2 ë¡œê·¸ í™•ì¸

```
[1] ğŸŒ ë¸Œë¼ìš°ì € ì‹œì‘: https://smartstore.naver.com/xxx...
[1] ğŸš€ ProductId ë°©ì‹: 12345678
[1] ğŸ§­ ë„¤ì´ë²„ ë©”ì¸ ì§„ì…
[1] â³ ê²€ìƒ‰ ê²°ê³¼ ëŒ€ê¸°...
[1] ğŸ›’ ì‡¼í•‘íƒ­ ì´ë™
[1] âœ… ìˆœìœ„ ë°œê²¬: 45ìœ„ (32ì´ˆ)
```

### 9.3 í”í•œ ë¬¸ì œ

| ì¦ìƒ | ì›ì¸ | í•´ê²° |
|-----|------|------|
| ìº¡ì±  ê°ì§€ | IP ì°¨ë‹¨ | IP ë¡œí…Œì´ì…˜ ë˜ëŠ” ëŒ€ê¸° |
| MID ì¶”ì¶œ ì‹¤íŒ¨ | ìƒí’ˆ í˜ì´ì§€ ì ‘ê·¼ ë¶ˆê°€ | URL í˜•ì‹ í™•ì¸ |
| ìˆœìœ„ ë¯¸ë°œê²¬ | 600ìœ„ ë°– ë˜ëŠ” ìƒí’ˆ ì‚­ì œ | ì •ìƒ ë™ì‘ |
| ë¸Œë¼ìš°ì € ì¶©ëŒ | ë©”ëª¨ë¦¬ ë¶€ì¡± | ì›Œì»¤ ìˆ˜ ì¤„ì´ê¸° |

---

## 10. ì½”ë“œ ìˆ˜ì • ê°€ì´ë“œ

### 10.1 ìƒˆë¡œìš´ MID ì¶”ì¶œê¸° ì¶”ê°€

```typescript
// rank-check/extractors/NewExtractor.ts
import type { IMidExtractor } from '../core/interfaces';

export class NewExtractor implements IMidExtractor {
  canHandle(url: string): boolean {
    return url.includes('new-domain.com');
  }

  async extract(url: string, page: Page): Promise<string | null> {
    // ì¶”ì¶œ ë¡œì§ êµ¬í˜„
  }
}

// MidExtractorFactoryì— ë“±ë¡
extractors.push(new NewExtractor());
```

### 10.2 ìˆœìœ„ ê³„ì‚° ë¡œì§

```typescript
// í˜„ì¬ ë¡œì§:
// ì „ì²´ ìˆœìœ„ = (page - 1) * 40 + pagePosition
//
// ì˜ˆ: 3í˜ì´ì§€ 15ë²ˆì§¸ â†’ (3-1)*40 + 15 = 95ìœ„
```

---

**ì‘ì„±ì**: Claude Code
**ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸**: 2025-12-29
